name: Ephemeral Issue

on:
  workflow_dispatch:
    inputs:
      environment:
        description: 'Environment'
        required: true
        default: 'Integration'
        type: choice
        options:
        - Integration
        - Certification
        
jobs:
  issue:
    name: Issue
    runs-on: ubuntu-latest
    permissions: write-all
    steps:
      - name: Create Issue
        run: |
          curl -L \
            -X POST \
            -H "Accept: application/vnd.github+json" \
            -H "Authorization: Bearer ${{ secrets.GITHUB_TOKEN }}" \
            -H "X-GitHub-Api-Version: 2022-11-28" \
            https://api.github.com/repos/${{ github.repository }}/issues \
            -d '{"title":"[EE] ${{ github.event.repository.name }}","body":"poc","assignees":["'"${{ github.actor }}"'"],"labels":["ephemeral", "main", "'"${{ inputs.environment}}"'"]}'
